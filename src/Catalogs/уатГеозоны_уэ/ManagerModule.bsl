#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// СтандартныеПодсистемы.ВерсионированиеОбъектов

// Определяет настройки объекта для подсистемы ВерсионированиеОбъектов.
//
// Параметры:
//  Настройки - Структура - настройки подсистемы.
Процедура ПриОпределенииНастроекВерсионированияОбъектов(Настройки) Экспорт
	
	Настройки.ПриПолученииСлужебныхРеквизитов = Ложь;
	
КонецПроцедуры

// Конец СтандартныеПодсистемы.ВерсионированиеОбъектов

#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс

Процедура ИспользоватьКакОсновнаяГеозона(Знач Геозона, ЗаписыватьОбъект = Истина) Экспорт
	
	// 1. Снимем пометку "Основная" у всех элементов, отличных от текущего.
	Запрос = Новый Запрос();
	Запрос.УстановитьПараметр("Ссылка", Геозона);
	
	Запрос.Текст =
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	уатГеозоны_уэ.Ссылка
	|ИЗ
	|	Справочник.уатГеозоны_уэ КАК уатГеозоны_уэ
	|ГДЕ
	|	НЕ уатГеозоны_уэ.ЭтоГруппа
	|	И уатГеозоны_уэ.Ссылка <> &Ссылка
	|	И уатГеозоны_уэ.Основная";
	
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл 
		СпрОб = Выборка.Ссылка.ПолучитьОбъект();
		СпрОб.Основная = Ложь;
		СпрОб.Записать();
	КонецЦикла;
	
	// 2. Установим пометку "Основная" у текущего элемента.
	Если НЕ ЗаписыватьОбъект Тогда
		Возврат;
	КОнецесли;
	
	СпрОб = Геозона.ПолучитьОбъект();
	СпрОб.Основная = Истина;
	СпрОб.Записать();
	
КонецПроцедуры

Функция ЕстьОсновнаяГеозона(Знач Геозона) Экспорт
	Запрос = Новый Запрос();
	Запрос.УстановитьПараметр("Ссылка", Геозона);
	
	Запрос.Текст =
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ ПЕРВЫЕ 1
	|	уатГеозоны_уэ.Ссылка КАК Ссылка
	|ИЗ
	|	Справочник.уатГеозоны_уэ КАК уатГеозоны_уэ
	|ГДЕ
	|	НЕ уатГеозоны_уэ.ЭтоГруппа
	|	И уатГеозоны_уэ.Ссылка <> &Ссылка
	|	И уатГеозоны_уэ.Основная";

	Возврат НЕ Запрос.Выполнить().Пустой();
	
КонецФункции

#КонецОбласти

#КонецЕсли