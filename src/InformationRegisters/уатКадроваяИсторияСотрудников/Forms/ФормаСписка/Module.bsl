
&НаКлиенте
Перем мсвСотрудникиДляОбновления;


#Область ОбработчикиСобытийФормы

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	уатЗащищенныеФункцииКлиент.уатРегистрФормаСпискаПриОткрытии(Отказ, ДопПараметрыОткрытие);
	Если Отказ Тогда
		Возврат;
	КонецЕсли;
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	уатЗащищенныеФункцииСервер.уатРегистрФормаСпискаПриСозданииНаСервере(Отказ, СтандартнаяОбработка, ДопПараметрыОткрытие);
	Если Отказ тогда
		Возврат;
	КонецЕсли;
КонецПроцедуры

#КонецОбласти


#Область ОбработчикиСобытийЭлементовТаблицыФормы_Список

&НаКлиенте
Процедура СписокПередУдалением(Элемент, Отказ)
	мсвСотрудникиДляОбновления = ПолучитьСотрудниковДляОбновления(Элементы.Список.ВыделенныеСтроки);
КонецПроцедуры

&НаКлиенте
Процедура СписокПослеУдаления(Элемент)
	уатОбщегоНазначенияСервер.ОбновитьТекущееМестоРаботыВСправочникеСотрудники(мсвСотрудникиДляОбновления);
	Оповестить("ИзменениеМестаРаботыСотрудника", мсвСотрудникиДляОбновления);
КонецПроцедуры

#КонецОбласти


#Область СлужебныеПроцедурыИФункции

&НаСервере
Функция ПолучитьСотрудниковДляОбновления(Знач ВыделенныеСтроки)
	мсвРез = Новый Массив;
	Для Каждого ТекСтрока Из ВыделенныеСтроки Цикл
		Если мсвРез.Найти(ТекСтрока.Сотрудник) = Неопределено Тогда
			мсвРез.Добавить(ТекСтрока.Сотрудник);
		КонецЕсли;
	КонецЦикла;
	
	Возврат мсвРез;
КонецФункции

#КонецОбласти
