#Область СлужебныеПроцедурыИФункции

// Функция создает список серийных номеров с НачСН по КонСН
// Для создания списка получаем кусок серийного номера слева, который можно преобразовать в число.
// Создаем список исходя из диапазона полученных чисел
//
// Параметры: НачСН - начальное значение серийного номера 
//			 КонСН - Конечное значение серийного номера
//
// Возвращаемое значение:
// Список - список серийных номеров
Функция СоздатьСписокСерийныхНомеров(НачСН, КоличествоСН) Экспорт
	Список = новый СписокЗначений();
	ДлинаЧисловойЧасти = 0;
	
	ЦифроваяЧастьСН = 0;
	БуквЧастьСН = "";
	сч = СтрДлина(НачСН);
	Пока сч >= 1 Цикл //идем посимвольно справа налево и ищем букву
		Стр = Сред(НачСН, сч, 1);
		Если Найти("0123456789", Стр) = 0 Тогда //это не цифра
			БуквЧастьСН = Лев(НачСН, сч);
			ЦифроваяЧастьСН = ?(сч = СтрДлина(НачСН), 0, Число(Прав(НачСН, СтрДлина(НачСН) - сч)));
			Прервать;
		КонецЕсли;
		сч = сч - 1;
	КонецЦикла;
	Если НЕ ЗначениеЗаполнено(БуквЧастьСН) тогда
		Попытка 
			ДлинаЧисловойЧасти = СтрДлина(НачСН);
			ЦифроваяЧастьСН = Число(НачСН);
		Исключение
		КонецПопытки;
	КонецЕсли;
	
	Список.Добавить(НачСН);                      
	ПредНомер = ЦифроваяЧастьСН;
	
	Для сч = 1 по КоличествоСН-1 Цикл //один мы уже ранее добавили, поэтому здесь на 1 меньше
		ТекНомер = ЦифроваяЧастьСН + сч;
		
		ДлинаЧисловойЧасти = СтрДлина(Формат(ТекНомер, "ЧГ="));
		сн = БуквЧастьСН + Формат(ТекНомер, "ЧВН=; ЧГ=" + ?(ДлинаЧисловойЧасти <> 0, ";ЧЦ=" + ДлинаЧисловойЧасти, ""));
		Список.Добавить(сн);	
	КонецЦикла;	
	
	Возврат Список;	
КонецФункции

#КонецОбласти
