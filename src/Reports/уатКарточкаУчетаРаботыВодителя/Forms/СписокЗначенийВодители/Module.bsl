
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если Параметры.Свойство("Список") Тогда
		Если ТипЗнч(Параметры.Список) = Тип("СправочникСсылка.Сотрудники") Тогда
			Список.Добавить(Параметры.Список);
		Иначе
			Список = Параметры.Список;
		КонецЕсли;
	КонецЕсли;
КонецПроцедуры

#КонецОбласти


#Область ОбработчикиСобытийЭлементовТаблицыФормы

&НаКлиенте
Процедура СписокПриНачалеРедактирования(Элемент, НоваяСтрока, Копирование)
	Элемент.ТекущийЭлемент.ВыбиратьТип = Ложь; 
	Элемент.ТекущийЭлемент.ОграничениеТипа=Новый ОписаниеТипов("СправочникСсылка.Сотрудники");
КонецПроцедуры

&НаКлиенте
Процедура СписокЗначениеНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	уатЗащищенныеФункцииКлиент.ДиалогВыбораСотрудника(Элемент,ДанныеВыбора,, СтандартнаяОбработка);
КонецПроцедуры

#КонецОбласти


#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура ОК(Команда)
	УдалитьДубли();
	Закрыть(Список);
КонецПроцедуры

&НаКлиенте
Процедура Подбор(Команда)
	
	ПараметрыФормы = Новый Структура("РежимВыбора, МножественныйВыбор, ЗакрыватьПриВыборе", Истина, Истина, Ложь);
	ОткрытьФорму("Справочник.Сотрудники.Форма.ФормаСписка", ПараметрыФормы, Элементы.Список);
	
КонецПроцедуры

#КонецОбласти


#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура УдалитьДубли()
	Таблица = Новый ТаблицаЗначений();
	Таблица.Колонки.Добавить("Водитель");
	Для Каждого ТекСтрока Из Список Цикл 
		Если ТекСтрока.Значение <> Неопределено Тогда
			Строка = Таблица.Добавить();
			Строка.Водитель = ТекСтрока.Значение;
		КонецЕсли;
	КонецЦикла;
	Таблица.Свернуть("Водитель");
	Список.ЗагрузитьЗначения(Таблица.ВыгрузитьКолонку("Водитель"));
КонецПроцедуры

#КонецОбласти
