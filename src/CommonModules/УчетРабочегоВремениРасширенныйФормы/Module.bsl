
#Область СлужебныеПроцедурыИФункции

// Процедура заполняет заголовки полей таблицы "подневного" ввода данных,
// а также делает невидимыми колонки с 29 по 31 
// в зависимости от количества дней в выбранном месяце.
//
// Параметры:
//	ЭлементыФормы - коллекция элементов формы.
//	Месяц - дата, начало выбранного месяца.
//	ШаблонИмениПоля - строка, имя поля дня, в котором номер дня обозначен "%1".
//
Процедура ОформитьПоляТаблицыДнейМесяца(ЭлементыФормы, Месяц, ШаблонИмениПоля) Экспорт
	
	ЦветРабочегоДня = ЦветаСтиля.ЦветТекстаФормы;
	ЦветВыходногоДня = ЦветаСтиля.ЦветОсобогоТекста;
	
	//ПоследнийДеньМесяца = ЗарплатаКадрыКлиентСервер.КоличествоДнейМесяца(Месяц);
	ПоследнийДеньМесяца = День(КонецМесяца(Месяц));

	Для НомерДня = 1 По ПоследнийДеньМесяца Цикл
		
		ТекущийДень = Дата(Год(Месяц), Месяц(Месяц), НомерДня);
		
		ДеньНедели = ДеньНедели(ТекущийДень);
		
		Элемент = ЭлементыФормы[СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(ШаблонИмениПоля, НомерДня)];
		Элемент.Заголовок = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
								"%1%2%3", НомерДня, Символы.ПС, Формат(ТекущийДень, НСтр("ru = 'Л=ru; ДФ=ддд'; en = 'Л=en; ДФ=ддд'")));
		Элемент.ЦветТекстаЗаголовка = ?(ДеньНедели = 6 Или ДеньНедели = 7, ЦветВыходногоДня, ЦветРабочегоДня);
		
	КонецЦикла;		
КонецПроцедуры	

Процедура ТабельПриЧтенииНаСервере(Форма) Экспорт
	
	ТабельПриЧтенииДанных(Форма);
	
КонецПроцедуры

Процедура ТабельПриСозданииНаСервере(Форма, Отказ, СтандартнаяОбработка) Экспорт 
	
	Если Форма.Параметры.Ключ.Пустая() Тогда
		Форма.ВысотаСтроки = 2;
			
		Если Не ЗначениеЗаполнено(Форма.Объект.ДатаНачалаПериода)
			И Не ЗначениеЗаполнено(Форма.Объект.ДатаОкончанияПериода) Тогда
			УчетРабочегоВремениРасширенныйКлиентСервер.ТабельУстановитьПериодДокумента(Форма);
		КонецЕсли;
		
		ТабельПриЧтенииДанных(Форма);
	КонецЕсли;
	
	ВидВремениЯвка = ОбщегоНазначенияКлиентСервер.ПредопределенныйЭлемент("Справочник.уатВидыИспользованияРабочегоВремени.Явка");
	Форма.ОбозначениеВидаВремениПоУмолчанию = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(ВидВремениЯвка, "БуквенныйКод");
	
КонецПроцедуры

Процедура ТабельПриЧтенииДанных(Форма)
	
	Если ТипЗнч(Форма.ОписаниеВидовВремени) <> Тип("ФиксированноеСоответствие") Тогда
		ТабельПоместитьОписаниеВидовВремениВДанныеФормы(форма);
	КонецЕсли;
	
	ТабельУстановитьВидимостьКолонокДнейПериода(Форма);
	
	ТабельДанныеВРеквизит(Форма);
	ТабельЗаполнитьНормуВремени(Форма);
	
	ОформитьПоляТаблицыДнейМесяца(Форма.Элементы, НачалоМесяца(Форма.Объект.ДатаНачалаПериода), "ДанныеОВремениВремя%1Представление");
	
КонецПроцедуры

Процедура ТабельУстановитьВидимостьКолонокДнейПериода(Форма)
	ПервыйДеньПериода = День(Форма.Объект.ДатаНачалаПериода);
	ПоследнийДеньПериода = День(Форма.Объект.ДатаОкончанияПериода);
	
	Для НомерДня = 1 По ПервыйДеньПериода - 1 Цикл
		Форма.Элементы["ДанныеОВремениВремя" + НомерДня + "Представление"].Видимость = Ложь;		
	КонецЦикла;	
	
	Для НомерДня = ПервыйДеньПериода По ПоследнийДеньПериода Цикл
		Форма.Элементы["ДанныеОВремениВремя" + НомерДня + "Представление"].Видимость = Истина;		
	КонецЦикла;	
	
	Для НомерДня = ПоследнийДеньПериода + 1 По 31 Цикл
		Форма.Элементы["ДанныеОВремениВремя" + НомерДня + "Представление"].Видимость = Ложь;		
	КонецЦикла;		
КонецПроцедуры	

Процедура ТабельПередЗаписьюНаСервере(Форма, Отказ, ТекущийОбъект, ПараметрыЗаписи) Экспорт
	МассивУдаляемыхСтрок = Новый Массив;
	ТекущийСотрудник = Неопределено;
	ГоловнаяСтрокаПоСотруднику = Неопределено;	
	ГоловнаяСтрокаНеЗаполнена = Ложь;
	ЕстьЗаполненныеСтроки = Ложь;
	Для Каждого СтрокаДанныхОВремени Из ТекущийОбъект.ДанныеОВремени Цикл
		Если СтрокаДанныхОВремени.Сотрудник <> ТекущийСотрудник Тогда
			Если ГоловнаяСтрокаПоСотруднику <> Неопределено И ГоловнаяСтрокаНеЗаполнена И ЕстьЗаполненныеСтроки Тогда
				МассивУдаляемыхСтрок.Добавить(ГоловнаяСтрокаПоСотруднику);				
			КонецЕсли;	
			
			ГоловнаяСтрокаПоСотруднику = СтрокаДанныхОВремени;
			ГоловнаяСтрокаНеЗаполнена = Ложь;
			ЕстьЗаполненныеСтроки = Ложь;
		КонецЕсли;
		
		СтрокаЗаполнена = Ложь;
		Для НомерДня = 1 По 31 Цикл
			Если  ЗначениеЗаполнено(СтрокаДанныхОВремени["ВидВремени" + НомерДня]) Тогда
				СтрокаЗаполнена = Истина;
			КонецЕсли;	
		КонецЦикла;	
		
		Если СтрокаДанныхОВремени <> ГоловнаяСтрокаПоСотруднику И Не СтрокаЗаполнена Тогда
			МассивУдаляемыхСтрок.Добавить(СтрокаДанныхОВремени);
		ИначеЕсли СтрокаДанныхОВремени = ГоловнаяСтрокаПоСотруднику И Не СтрокаЗаполнена Тогда  
			ГоловнаяСтрокаНеЗаполнена = Истина;
		Иначе 
			ЕстьЗаполненныеСтроки = Истина;	
		КонецЕсли;	
		
		ТекущийСотрудник = СтрокаДанныхОВремени.Сотрудник; 
	КонецЦикла;	
	
	Если ГоловнаяСтрокаПоСотруднику <> Неопределено И ГоловнаяСтрокаНеЗаполнена И ЕстьЗаполненныеСтроки Тогда
		МассивУдаляемыхСтрок.Добавить(ГоловнаяСтрокаПоСотруднику);				
	КонецЕсли;
	
	Для Каждого УдаляемаяСтрока Из МассивУдаляемыхСтрок Цикл
		ТекущийОбъект.ДанныеОВремени.Удалить(УдаляемаяСтрока);		
	КонецЦикла;	
КонецПроцедуры

Процедура ТабельПослеЗаписиНаСервере(Форма, ТекущийОбъект, ПараметрыЗаписи) Экспорт
	ТабельДанныеВРеквизит(Форма);
КонецПроцедуры

Процедура ТабельОбновитьДанныеПоСотрудникам(Форма) Экспорт
	Объект = Форма.Объект;
	
	ТаблицаСотрудников = ТабельПустаяТаблицаСотрудников();
	
	СтрокиПоСотрудникам = Новый Соответствие;
	
	СотрудникиДокумента = Новый Массив;
	
	Для Каждого СтрокаДанныхОВремени Из Объект.ДанныеОВремени Цикл
		Если СтрокаДанныхОВремени.ЭтоПерваяСтрокаПоСотруднику Тогда 
			МассивСтрокПоСотруднику = УчетРабочегоВремениРасширенныйКлиентСервер.ТабельСтрокиПоСотруднику(Объект.ДанныеОВремени, СтрокаДанныхОВремени.НомерСтрокиСотрудник);
	
			ТабельОчиститьСтрокиСотрудника(МассивСтрокПоСотруднику);
						
			СтрокиПоСотрудникам.Вставить(СтрокаДанныхОВремени.Сотрудник, МассивСтрокПоСотруднику);			
		КонецЕсли;	
	КонецЦикла;	
	
	ТабельЗаполнитьДанныеПоСотрудникам(Форма, СотрудникиДокумента, СтрокиПоСотрудникам, 2);
	
КонецПроцедуры	

Процедура ТабельЗаполнитьСотрудникамиОрганизации(Форма, ЗаполнятьТерриторииИУсловия = Ложь) Экспорт
	Объект = Форма.Объект;
	
	Если Не ТабельМожноЗаполнитьАвтоматически(Объект) Тогда
		Возврат;		
	КонецЕсли;	
	
	Объект.ДанныеОВремени.Очистить();
	ТабельЗаполнитьДанныеПоСотрудникам(Форма,,,, ЗаполнятьТерриторииИУсловия);
	
КонецПроцедуры	

Процедура ТабельЗаполнитьДанныеПоСотруднику(Форма, ЗаполнятьТерриторииИУсловия = Ложь) Экспорт
	Объект = Форма.Объект;
			
	ГоловнаяСтрокаСотрудника = Объект.ДанныеОВремени.НайтиПоИдентификатору(Форма.Элементы.ДанныеОВремени.ТекущаяСтрока);
	
	Если ГоловнаяСтрокаСотрудника.НеЗаполнятьПриИзмененииСотрудника Тогда
		ГоловнаяСтрокаСотрудника.НеЗаполнятьПриИзмененииСотрудника = Ложь;
		Сотрудник = ГоловнаяСтрокаСотрудника.Сотрудник;
		
		МассивСтрокПоСотруднику = УчетРабочегоВремениРасширенныйКлиентСервер.ТабельСтрокиПоСотруднику(Объект.ДанныеОВремени, ГоловнаяСтрокаСотрудника.НомерСтрокиСотрудник);
		
		Для Каждого СтрокаТабеля Из МассивСтрокПоСотруднику Цикл
			СтрокаТабеля.Сотрудник = Сотрудник;	
		КонецЦикла;	
	Иначе	
		МассивСтрокПоСотруднику = УчетРабочегоВремениРасширенныйКлиентСервер.ТабельСтрокиПоСотруднику(Объект.ДанныеОВремени, ГоловнаяСтрокаСотрудника.НомерСтрокиСотрудник);
	
		ТабельОчиститьСтрокиСотрудника(МассивСтрокПоСотруднику);
		
		СписокСотрудников = Новый Массив;
		СписокСотрудников.Добавить(ГоловнаяСтрокаСотрудника.Сотрудник);
		
		СтрокиПоСотрудникам = Новый Соответствие;
		СтрокиПоСотрудникам.Вставить(ГоловнаяСтрокаСотрудника.Сотрудник, МассивСтрокПоСотруднику);
				
		ТабельЗаполнитьДанныеПоСотрудникам(Форма, СписокСотрудников, СтрокиПоСотрудникам, Форма.ВысотаСтроки, ЗаполнятьТерриторииИУсловия);
	КонецЕсли;		
КонецПроцедуры	

Процедура ТабельОбработкаПодбора(Форма, СписокСотрудников, ЗаполнятьТерриторииИУсловия = Ложь) Экспорт
	Объект = Форма.Объект;
	
	ТаблицаСотрудников = ТабельПустаяТаблицаСотрудников();
	
	ОбщееКоличествоСтрок = Объект.ДанныеОВремени.Количество();
	
	Если ОбщееКоличествоСтрок = 0 Тогда
		НомерТекущейСтроки = 1;
	Иначе	
		НомерТекущейСтроки = Объект.ДанныеОВремени[ОбщееКоличествоСтрок - 1].НомерСтрокиСотрудник + 1; 
	КонецЕсли;	
	
	ДобавляемыеСотрудники = Новый Массив;
	СтрокиПоСотрудникам = Новый Соответствие;
	
	Для Каждого Сотрудник Из СписокСотрудников Цикл
		Если Объект.ДанныеОВремени.НайтиСтроки(Новый Структура("Сотрудник", Сотрудник)).Количество() = 0 Тогда
			ДобавляемыеСотрудники.Добавить(Сотрудник);
			
			СтрокиПоСотруднику = ТабельНоваяСтрокаДанныхОВремени(Объект.ДанныеОВремени, Сотрудник, НомерТекущейСтроки, Форма.ВысотаСтроки);
			СтрокиПоСотрудникам.Вставить(Сотрудник, СтрокиПоСотруднику);
			НомерТекущейСтроки = НомерТекущейСтроки + 1;
		КонецЕсли;	
	КонецЦикла;	
		
	ТабельЗаполнитьДанныеПоСотрудникам(Форма, ДобавляемыеСотрудники, СтрокиПоСотрудникам, Форма.ВысотаСтроки, ЗаполнятьТерриторииИУсловия);
КонецПроцедуры	

Процедура ТабельЗаполнитьДанныеПоСотрудникам(Форма, СписокСотрудников = Неопределено, СтрокиПоСотрудникам = Неопределено, ВысотаСтроки = 2, ЗаполнятьТерриторииИУсловия = Ложь)
	КодыВидовВремени = УчетРабочегоВремениРасширенный.КодыВидовВремени();
	
	МенеджерОбъекта = ОбщегоНазначения.МенеджерОбъектаПоСсылке(Форма.Объект.Ссылка);
	
	ВыборкаДанныхОВремени = МенеджерОбъекта.ДанныеОВремениСотрудников(Форма.Объект, СписокСотрудников);
	
	ТекущийСотрудник = Неопределено;
	ДанныеОВремениПоСотруднику = Новый Массив;
	НомерСтрокиСотрудник = 1;
	
	ДанныеОВремениПоСотруднику = Новый ТаблицаЗначений;
	ДанныеОВремениПоСотруднику.Колонки.Добавить("Сотрудник");
	ДанныеОВремениПоСотруднику.Колонки.Добавить("ВидУчетаВремени");
	ДанныеОВремениПоСотруднику.Колонки.Добавить("Дата");
	ДанныеОВремениПоСотруднику.Колонки.Добавить("Дни");
	ДанныеОВремениПоСотруднику.Колонки.Добавить("Часы");
	
	Пока ВыборкаДанныхОВремени.СледующийПоЗначениюПоля("Сотрудник") Цикл
		ДанныеОВремениПоСотруднику.Очистить();
		Пока ВыборкаДанныхОВремени.Следующий() Цикл
			СтрокаТаблицыДанныхОВремени = ДанныеОВремениПоСотруднику.Добавить();
			ЗаполнитьЗначенияСвойств(СтрокаТаблицыДанныхОВремени, ВыборкаДанныхОВремени);
		КонецЦикла;	
		
		УдалитьПустыеВыходныеЕслиЕстьРабочееВремя(ДанныеОВремениПоСотруднику);
		
		Если СтрокиПоСотрудникам = Неопределено Тогда
			МассивСтрокПоСотруднику = ТабельНоваяСтрокаДанныхОВремени(Форма.Объект.ДанныеОВремени, ВыборкаДанныхОВремени.Сотрудник, НомерСтрокиСотрудник, Форма.ВысотаСтроки);
		Иначе					
			МассивСтрокПоСотруднику = СтрокиПоСотрудникам[ВыборкаДанныхОВремени.Сотрудник];
		КонецЕсли;	
		
		ТабельЗаполнитьСтрокиПоСотруднику(
			Форма, 
			ДанныеОВремениПоСотруднику, 
			МассивСтрокПоСотруднику, 
			КодыВидовВремени, 
			ВысотаСтроки,
			ЗаполнятьТерриторииИУсловия);
			
		НомерСтрокиСотрудник = НомерСтрокиСотрудник + 1;	
	КонецЦикла;	
		
	ТабельУстановитьВысотуСтрокПоСотрудникам(Форма, ВысотаСтроки);
	
	ТабельЗаполнитьИтогиПоСотрудникамДокумента(Форма);
КонецПроцедуры	

Процедура ТабельПериодРегистрацииПриИзменении(Форма) Экспорт
	Объект = Форма.Объект;
	
	//УчетРабочегоВремениРасширенныйКлиентСервер.ТабельУстановитьПериодДокумента(Форма);
	ОформитьПоляТаблицыДнейМесяца(Форма.Элементы, НачалоМесяца(Объект.ДатаНачалаПериода), "ДанныеОВремениВремя%1Представление");	
	
	ТабельУстановитьВидимостьКолонокДнейПериода(Форма);
	
	ТабельПоместитьОписаниеВидовВремениВДанныеФормы(Форма);
КонецПроцедуры

Функция ТабельМожноЗаполнитьАвтоматически(Объект)
	Отказ = Ложь;
	Если Не ЗначениеЗаполнено(Объект.Организация) Тогда
		ТекстСообщения = НСтр("en='Company is not specified.';ru='Не указана организация.'");
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстСообщения, Объект.Ссылка, "Организация", "Объект", Отказ); 
	КонецЕсли;
	Возврат Не Отказ;	
КонецФункции	

Процедура ТабельДанныеВРеквизит(Форма)
	
	Объект = Форма.Объект;
	
	Форма.КоличествоПолностьюЗаполненныхСтрок = 0;
	
	КодыВидовВремени = УчетРабочегоВремениРасширенный.КодыВидовВремени();
	
	ТекущийСотрудник = Неопределено;
	ТекущийНомерСтроки = 0;
	
	ВысотаСтроки = 0;
	
	СоответствиеСотрудниковСтрокам = Новый Соответствие;
	
	ВысотаСтрокПоСотрудникам = Новый Соответствие;
	
	Для Каждого СтрокаДанныхОВремени Из Объект.ДанныеОВремени Цикл
		Если СтрокаДанныхОВремени.Сотрудник <> ТекущийСотрудник Тогда
			ТекущийНомерСтроки = ТекущийНомерСтроки + 1;
			ЧетнаяСтрока = (ТекущийНомерСтроки % 2 = 0);; 
			СтрокаДанныхОВремени.ЭтоПерваяСтрокаПоСотруднику = Истина;
			
			СоответствиеСотрудниковСтрокам.Вставить(СтрокаДанныхОВремени.Сотрудник, СтрокаДанныхОВремени);
		КонецЕсли;
		
		СтрокаДанныхОВремени.НомерСтрокиСотрудник = ТекущийНомерСтроки;
		СтрокаДанныхОВремени.ЧетнаяСтрока = ЧетнаяСтрока;
		
		Для НомерДня = 1 По 31 Цикл
			ОбозначениеВремени = КодыВидовВремени.Получить(СтрокаДанныхОВремени["ВидВремени" + НомерДня]);
			Часы = СтрокаДанныхОВремени["Часов" + НомерДня];
			СтрокаДанныхОВремени["Время" + НомерДня + "Представление"] = УчетРабочегоВремениРасширенныйКлиентСервер.ТабельПредставлениеВремениПоВиду(ОбозначениеВремени, Часы, Форма.ЭтотОбъект.ПереключательВидаОтображенияВремени);
		КонецЦикла;
		
		ТекущийСотрудник = СтрокаДанныхОВремени.Сотрудник;
	КонецЦикла;
	
	ОбозначенияВидовВремени = УчетРабочегоВремениРасширенныйКлиентСервер.ТабельОбозначенияВидовВремени(Форма.ОписаниеВидовВремени);
	Для Каждого ГоловнаяСтрока Из СоответствиеСотрудниковСтрокам Цикл
		МассивСтрок = УчетРабочегоВремениРасширенныйКлиентСервер.ТабельСтрокиПоСотруднику(Объект.ДанныеОВремени, ГоловнаяСтрока.Значение.НомерСтрокиСотрудник);
		ВысотаСтроки = Макс(ВысотаСтроки, МассивСтрок.Количество());
		ВысотаСтрокПоСотрудникам.Вставить(ГоловнаяСтрока.Значение, МассивСтрок.Количество());
	КонецЦикла;
	
	Форма.ВысотаСтроки = Макс(Форма.ВысотаСтроки, ?(ВысотаСтроки = 1, 2, ВысотаСтроки));
	
	Для Каждого КлючЗначение Из ВысотаСтрокПоСотрудникам Цикл
		ТабельДополнитьСтрокуПоСотруднику(Объект.ДанныеОВремени, КлючЗначение.Ключ, Форма.ВысотаСтроки - КлючЗначение.Значение);
		Если КлючЗначение.Значение = Форма.ВысотаСтроки Тогда 
			Форма.КоличествоПолностьюЗаполненныхСтрок = Форма.КоличествоПолностьюЗаполненныхСтрок + 1;
		КонецЕсли;
	КонецЦикла;
	
	ТабельЗаполнитьИтогиПоСотрудникамДокумента(Форма);
	
	УчетРабочегоВремениРасширенныйКлиентСервер.ТабельУстановитьИнфонадписьВысотаСтрок(Форма);
	
КонецПроцедуры

Процедура ТабельЗаполнитьНормуВремени(Форма)
	ТаблицаСотрудников = ТабельПустаяТаблицаСотрудников();	
	
	Объект = Форма.Объект;
	
	СоответствиеСотрудниковСтрокам = Новый Соответствие;
	
	СтрокиПоСотрудникам = УчетРабочегоВремениРасширенныйКлиентСервер.ТабельГоловныеСтрокиСотрудников(Объект.ДанныеОВремени);
	
	Для Каждого ГоловнаяСтрока Из СтрокиПоСотрудникам Цикл
		СтрокаТаблицы = ТаблицаСотрудников.Добавить();
		СтрокаТаблицы.Сотрудник = ГоловнаяСтрока.Сотрудник; 
		СтрокаТаблицы.ПериодДействия = НачалоМесяца(Объект.ДатаНачалаПериода);
		
		СоответствиеСотрудниковСтрокам.Вставить(ГоловнаяСтрока.Сотрудник, ГоловнаяСтрока);	
	КонецЦикла;	
	
	НеучитываемыеДокументы = Новый Массив;
	Если Не Объект.Ссылка.Пустая() Тогда
		НеучитываемыеДокументы.Добавить(Объект.Ссылка);
	КонецЕсли;	
	
	//ВыборкаПоНормеВремени = УчетРабочегоВремениРасширенный.СформироватьЗапросПоНормеВремени(ТаблицаСотрудников, НеучитываемыеДокументы).Выбрать();
	//
	//Пока ВыборкаПоНормеВремени.СледующийПоЗначениюПоля("Сотрудник") Цикл
	//	ГоловнаяСтрокаСотрудника = СоответствиеСотрудниковСтрокам.Получить(ВыборкаПоНормеВремени.Сотрудник);
	//	СтрокиПоСотруднику = УчетРабочегоВремениРасширенныйКлиентСервер.ТабельСтрокиПоСотруднику(Объект.ДанныеОВремени, ГоловнаяСтрокаСотрудника.НомерСтрокиСотрудник);
	//	Пока ВыборкаПоНормеВремени.СледующийПоЗначениюПоля("Период") Цикл
	//		НомерДня = День(ВыборкаПоНормеВремени.Период);
	//		ГоловнаяСтрокаСотрудника["ЧасовНорма" + НомерДня] = ВыборкаПоНормеВремени.НормаЧасов;	
	//		ГоловнаяСтрокаСотрудника["ВидВремениПоУмолчаниюОбозначение" + НомерДня] = ВыборкаПоНормеВремени.ВидВремениПоУмолчаниюОбозначение;
	//	КонецЦикла;	
	//КонецЦикла;	
	
КонецПроцедуры	

Процедура ТабельДополнитьСтрокуПоСотруднику(ДанныеОВремени, ГоловнаяСтрока, КоличествоДобавляемыхСтрок)
	Для Сч = 1 По КоличествоДобавляемыхСтрок Цикл
		УчетРабочегоВремениРасширенныйКлиентСервер.ТабельНоваяСтрокаПоСотруднику(ДанныеОВремени, ГоловнаяСтрока);			
	КонецЦикла;	
КонецПроцедуры	

Функция ТабельПустаяТаблицаСотрудников()
	ТаблицаСотрудников = Новый ТаблицаЗначений;
	ТаблицаСотрудников.Колонки.Добавить("Сотрудник", Новый ОписаниеТипов("СправочникСсылка.Сотрудники"));
	ТаблицаСотрудников.Колонки.Добавить("ПериодДействия", Новый ОписаниеТипов("Дата"));
	//ТаблицаСотрудников.Колонки.Добавить("ПериодРегистрации", Новый ОписаниеТипов("Дата"));
	
	Возврат ТаблицаСотрудников;
КонецФункции	

Процедура ТабельУстановитьВысотуСтрокПоСотрудникам(Форма, НоваяВысотаСтроки) Экспорт
	
	Если Форма.ВысотаСтроки <> НоваяВысотаСтроки Тогда
		ГоловныеСтроки = УчетРабочегоВремениРасширенныйКлиентСервер.ТабельГоловныеСтрокиСотрудников(Форма.Объект.ДанныеОВремени);
		
		Если НоваяВысотаСтроки > Форма.ВысотаСтроки Тогда
			Для Каждого ГоловнаяСтрокаСотрудника Из ГоловныеСтроки Цикл
				СтрокиПоСотруднику = УчетРабочегоВремениРасширенныйКлиентСервер.ТабельСтрокиПоСотруднику(Форма.Объект.ДанныеОВремени, ГоловнаяСтрокаСотрудника.НомерСтрокиСотрудник); 
				
				Если СтрокиПоСотруднику.Количество() < НоваяВысотаСтроки Тогда 
					Для НомерСтроки = Форма.ВысотаСтроки + 1 По НоваяВысотаСтроки Цикл
						УчетРабочегоВремениРасширенныйКлиентСервер.ТабельНоваяСтрокаПоСотруднику(Форма.Объект.ДанныеОВремени, ГоловнаяСтрокаСотрудника);
					КонецЦикла;	
				КонецЕсли;	
					
			КонецЦикла;	
			Форма.КоличествоПолностьюЗаполненныхСтрок = 0;
			
			ТабельЗаполнитьИтогиПоСотрудникамДокумента(Форма);
		Иначе
			Отказ = Ложь;
			КоличествоУдаляемыхСтрок = Форма.ВысотаСтроки - НоваяВысотаСтроки;
			НомерТекущейСтроки = 1;
			СтрокиПоСотруднику = Новый Массив(Форма.ВысотаСтроки);
			НомерСтрокиПоСотруднику = 0;
			УдаляемыеСтроки = Новый Массив;
			Для Каждого СтрокаДанных Из Форма.Объект.ДанныеОВремени Цикл
				Если НомерТекущейСтроки = СтрокаДанных.НомерСтрокиСотрудник Тогда
					НомерСтрокиПоСотруднику = НомерСтрокиПоСотруднику + 1;
					СтрокиПоСотруднику[НомерСтрокиПоСотруднику - 1] = СтрокаДанных;
				Иначе
					КоличествоУдаляемыхСтрокПоСотруднику = 0;
                    ТабельЗаполнитьУдаляемыеСтрокиПоСотруднику(УдаляемыеСтроки, СтрокиПоСотруднику, КоличествоУдаляемыхСтрок, Форма.ВысотаСтроки, КоличествоУдаляемыхСтрокПоСотруднику);
					
					Если КоличествоУдаляемыхСтрокПоСотруднику <> КоличествоУдаляемыхСтрок Тогда
						Отказ = Истина;
						Прервать;
					КонецЕсли;	
					
					СтрокиПоСотруднику = Новый Массив(Форма.ВысотаСтроки);
					НомерТекущейСтроки = СтрокаДанных.НомерСтрокиСотрудник;
					НомерСтрокиПоСотруднику = 1;
					
					СтрокиПоСотруднику[НомерСтрокиПоСотруднику - 1] = СтрокаДанных;
					
				КонецЕсли;	
			КонецЦикла;
			
			КоличествоУдаляемыхСтрокПоСотруднику = 0;
            ТабельЗаполнитьУдаляемыеСтрокиПоСотруднику(УдаляемыеСтроки, СтрокиПоСотруднику, КоличествоУдаляемыхСтрок, Форма.ВысотаСтроки, КоличествоУдаляемыхСтрокПоСотруднику);

			Если КоличествоУдаляемыхСтрокПоСотруднику <> КоличествоУдаляемыхСтрок Тогда
				Отказ = Истина;
			КонецЕсли;	
			
			Если Не Отказ Тогда
				Для Каждого УдаляемаяСтрока Из УдаляемыеСтроки Цикл
					Форма.Объект.ДанныеОВремени.Удалить(Форма.Объект.ДанныеОВремени.Индекс(УдаляемаяСтрока));		
				КонецЦикла;	
			КонецЕсли;	
		КонецЕсли;	
		Форма.ВысотаСтроки = НоваяВысотаСтроки;
		
		НомерТекущейСтроки = 1;
		ВсеСтрокиЗаполнены = Истина;
		Для Каждого СтрокаДанных Из Форма.Объект.ДанныеОВремени Цикл
			Если СтрокаДанных.НомерСтрокиСотрудник = НомерТекущейСтроки Тогда
				Если СтрокаДанных.ПустаяСтрока Тогда
					ВсеСтрокиЗаполнены = Ложь;
				КонецЕсли;
			Иначе
				НомерТекущейСтроки = СтрокаДанных.НомерСтрокиСотрудник;
				Если ВсеСтрокиЗаполнены Тогда
					Форма.КоличествоПолностьюЗаполненныхСтрок = Форма.КоличествоПолностьюЗаполненныхСтрок + 1;
				КонецЕсли;
				ВсеСтрокиЗаполнены = Не СтрокаДанных.ПустаяСтрока;
			КонецЕсли;	
		КонецЦикла;	
		
		Если ВсеСтрокиЗаполнены И (НомерТекущейСтроки > 1 Или Форма.Объект.ДанныеОВремени.Количество() = 1) Тогда
			Форма.КоличествоПолностьюЗаполненныхСтрок = Форма.КоличествоПолностьюЗаполненныхСтрок + 1;
		КонецЕсли;	
	КонецЕсли;	
	
	УчетРабочегоВремениРасширенныйКлиентСервер.ТабельУстановитьИнфонадписьВысотаСтрок(Форма);
КонецПроцедуры		

Процедура ТабельЗаполнитьУдаляемыеСтрокиПоСотруднику(УдаляемыеСтроки, СтрокиПоСотруднику, КоличествоУдаляемыхСтрок, ВысотаСтроки, КоличествоУдаляемыхСтрокПоСотруднику)
	Сч = 1;
	ФлагПродолжать = Сч < ВысотаСтроки;
	Пока ФлагПродолжать Цикл
		Если СтрокиПоСотруднику[ВысотаСтроки - Сч] <> Неопределено 
			И СтрокиПоСотруднику[ВысотаСтроки - Сч].ПустаяСтрока
			И Не СтрокиПоСотруднику[ВысотаСтроки - Сч].ЭтоПерваяСтрокаПоСотруднику  Тогда
			
			УдаляемыеСтроки.Добавить(СтрокиПоСотруднику[ВысотаСтроки - Сч]);
			КоличествоУдаляемыхСтрокПоСотруднику = КоличествоУдаляемыхСтрокПоСотруднику + 1;
		КонецЕсли;
		Сч = Сч + 1;
		ФлагПродолжать = Сч < ВысотаСтроки И КоличествоУдаляемыхСтрокПоСотруднику < КоличествоУдаляемыхСтрок;
	КонецЦикла;	
	
КонецПроцедуры	

Процедура ТабельПоместитьОписаниеВидовВремениВДанныеФормы(Форма) Экспорт
	ВидВремениЯвка = ОбщегоНазначенияКлиентСервер.ПредопределенныйЭлемент("Справочник.уатВидыИспользованияРабочегоВремени.Явка");
	
	СоответствиеБуквенныхОбозначенийОписаниям = Новый Соответствие;
	
	Менеджер = ОбщегоНазначения.МенеджерОбъектаПоСсылке(Форма.Объект.Ссылка);
	
	ДоступныеВидыВремени = Менеджер.ДоступныеДляВводаВидыВремени();
	
	Выборка = УчетРабочегоВремениРасширенный.СформироватьЗапросПоВидамВремени().Выбрать();	
	
	Пока Выборка.Следующий() Цикл
		Если ДоступныеВидыВремени.Получить(Выборка.ОсновноеВремя) <> Истина Тогда
			Продолжить;
		КонецЕсли;	
		
		Если Не ЗначениеЗаполнено(Выборка.БуквенныйКод) Тогда
			Продолжить;
		КонецЕсли;	
		
		Описание = Новый ФиксированнаяСтруктура(Новый Структура("ВидВремени, Наименование", Выборка.ВидВремени, Выборка.Наименование)); 
		СоответствиеБуквенныхОбозначенийОписаниям.Вставить(ВРег(Выборка.БуквенныйКод), Описание);	
		
		Если Выборка.ВидВремени = ВидВремениЯвка Тогда
			Форма.ОбозначениеВидаВремениПоУмолчанию = ВРег(Выборка.БуквенныйКод);
		КонецЕсли;	
	КонецЦикла;
	
	Форма.ОписаниеВидовВремени = Новый ФиксированноеСоответствие(СоответствиеБуквенныхОбозначенийОписаниям); 
КонецПроцедуры	

Процедура ТабельУдалитьСтрокиПоСотруднику(Форма, ИдентификаторУдаляемойСтроки) Экспорт
	Объект = Форма.Объект;
	
	ТекущаяСтрока = Объект.ДанныеОВремени.НайтиПоИдентификатору(ИдентификаторУдаляемойСтроки);
	
	Если ТекущаяСтрока <> Неопределено Тогда
	
		НомерПредыдущейСтроки = ТекущаяСтрока.НомерСтрокиСотрудник;
		
		ИндексОбрабатываемойСтроки = Объект.ДанныеОВремени.Индекс(ТекущаяСтрока);
		
		УдаляемыеСтроки = УчетРабочегоВремениРасширенныйКлиентСервер.ТабельСтрокиПоСотруднику(Объект.ДанныеОВремени, ТекущаяСтрока.НомерСтрокиСотрудник);
		
		Для Каждого УдаляемаяСтрока Из УдаляемыеСтроки Цикл  
			Если УдаляемаяСтрока.ЭтоПерваяСтрокаПоСотруднику Тогда
				ИндексОбрабатываемойСтроки = Объект.ДанныеОВремени.Индекс(УдаляемаяСтрока);	
			КонецЕсли;	
		КонецЦикла;	
	
		Для Каждого УдаляемаяСтрока Из УдаляемыеСтроки Цикл  
			Объект.ДанныеОВремени.Удалить(Объект.ДанныеОВремени.Индекс(УдаляемаяСтрока));
		КонецЦикла;	
		
		ОбщееКоличествоСтрок = Объект.ДанныеОВремени.Количество();
		
		Если ИндексОбрабатываемойСтроки < ОбщееКоличествоСтрок Тогда
			ДанныеТекущейСтроки = Объект.ДанныеОВремени[ИндексОбрабатываемойСтроки];
			ДанныеТекущейСтроки.НомерСтрокиСотрудник = НомерПредыдущейСтроки;
			НомерПредыдущейСтроки = ДанныеТекущейСтроки.НомерСтрокиСотрудник;
			ИндексОбрабатываемойСтроки = ИндексОбрабатываемойСтроки + 1;
			Форма.Элементы.ДанныеОВремени.ТекущаяСтрока = ДанныеТекущейСтроки.ПолучитьИдентификатор();
		КонецЕсли;	
		
		Пока ИндексОбрабатываемойСтроки < ОбщееКоличествоСтрок Цикл 
			ДанныеТекущейСтроки = Объект.ДанныеОВремени[ИндексОбрабатываемойСтроки];
					
			Если ДанныеТекущейСтроки.ЭтоПерваяСтрокаПоСотруднику Тогда
				ДанныеТекущейСтроки.НомерСтрокиСотрудник = НомерПредыдущейСтроки + 1;
				НомерПредыдущейСтроки = ДанныеТекущейСтроки.НомерСтрокиСотрудник;
			Иначе
				ДанныеТекущейСтроки.НомерСтрокиСотрудник = НомерПредыдущейСтроки;
			КонецЕсли;	
			ИндексОбрабатываемойСтроки = ИндексОбрабатываемойСтроки + 1;
		КонецЦикла;	
		
		УчетРабочегоВремениРасширенныйКлиентСервер.ТабельУстановитьИнфонадписьВысотаСтрок(Форма);
		
		Форма.Модифицированность = Истина;
	КонецЕсли;	
	
КонецПроцедуры	

Процедура ТабельЗаполнитьСтрокиПоСотруднику(Форма, ДанныеОВремениПоСотруднику, МассивСтрокПоСотруднику, КодыВидовВремени, ВысотаСтроки, ЗаполнятьТерриторииИУсловия = Ложь) Экспорт
	Объект = Форма.Объект;
	
	ВидВремениРабочееВремя = ОбщегоНазначенияКлиентСервер.ПредопределенныйЭлемент("Справочник.уатВидыИспользованияРабочегоВремени.РабочееВремя");
	
	ОбрабатываемаяДата = '00010101';	

	НормаЧасов = 0;
	МаксимальноеКоличествоВидовВремени = 0;
	МаксимальноеКоличествоЧасовНаДату = -1;
	ВидВремениПоУмолчанию = Неопределено;
	Для Каждого СтрокаДанныхОВремени Из ДанныеОВремениПоСотруднику Цикл
		Если СтрокаДанныхОВремени.ВидУчетаВремени = ВидВремениРабочееВремя Тогда
			Продолжить;
		КонецЕсли;	
		
		Если СтрокаДанныхОВремени.Дата <> ОбрабатываемаяДата Тогда 
			НомерДня = День(СтрокаДанныхОВремени.Дата);	
			НомерВидаВремениНаДату = 1;
			
			//Если ВидВремениПоУмолчанию <> Неопределено Тогда
			//	МассивСтрокПоСотруднику[0]["ВидВремениПоУмолчаниюОбозначение" + День(ОбрабатываемаяДата)] = КодыВидовВремени.Получить(ВидВремениПоУмолчанию);	
			//КонецЕсли;	
		Иначе
			НомерВидаВремениНаДату = НомерВидаВремениНаДату + 1;
		КонецЕсли;
		
		Если НомерВидаВремениНаДату > МассивСтрокПоСотруднику.Количество() Тогда
			СтрокаТабеля = УчетРабочегоВремениРасширенныйКлиентСервер.ТабельНоваяСтрокаПоСотруднику(Объект.ДанныеОВремени, МассивСтрокПоСотруднику[0]);	
			МассивСтрокПоСотруднику.Добавить(СтрокаТабеля);
		Иначе
			СтрокаТабеля = МассивСтрокПоСотруднику[НомерВидаВремениНаДату - 1];		
		КонецЕсли;	
		
		СтрокаТабеля["ВидВремени" + НомерДня] = СтрокаДанныхОВремени.ВидУчетаВремени;
		СтрокаТабеля["Часов" + НомерДня] = СтрокаДанныхОВремени.Часы;
		
		//Если НомерВидаВремениНаДату = 1 Тогда
		//	СтрокаТабеля["ЧасовНорма" + НомерДня] = СтрокаДанныхОВремени.НормаЧасов;
		//КонецЕсли;	
				
		БуквенноеОбозначение = КодыВидовВремени.Получить(СтрокаДанныхОВремени.ВидУчетаВремени);
		
		СтрокаТабеля["Время" + НомерДня + "Представление"] = УчетРабочегоВремениРасширенныйКлиентСервер.ТабельПредставлениеВремениПоВиду(БуквенноеОбозначение, СтрокаДанныхОВремени.Часы, Форма.ЭтотОбъект.ПереключательВидаОтображенияВремени);
		СтрокаТабеля.ПустаяСтрока = Ложь;
		
		ОбрабатываемаяДата = СтрокаДанныхОВремени.Дата;
		МаксимальноеКоличествоВидовВремени = Макс(МаксимальноеКоличествоВидовВремени, НомерВидаВремениНаДату);
		
		//Если СтрокаДанныхОВремени.Часы > МаксимальноеКоличествоЧасовНаДату Тогда
		//	ВидВремениПоУмолчанию = СтрокаДанныхОВремени.ВидУчетаВремени;	
		//КонецЕсли;	
	КонецЦикла;	
	
	//Если ВидВремениПоУмолчанию <> Неопределено И ОбрабатываемаяДата <> '00010101' Тогда
	//	МассивСтрокПоСотруднику[0]["ВидВремениПоУмолчаниюОбозначение" + День(ОбрабатываемаяДата)] = КодыВидовВремени.Получить(ВидВремениПоУмолчанию);	
	//КонецЕсли;	
	
	КоличествоСтрокПоСотруднику = МассивСтрокПоСотруднику.Количество();
	
	Сотрудник = МассивСтрокПоСотруднику[0].Сотрудник;
	
	Для Каждого СтрокаПоСотруднику Из МассивСтрокПоСотруднику Цикл
		СтрокаПоСотруднику.Сотрудник = Сотрудник;		
	КонецЦикла;	
		
	ВысотаСтроки = Макс(ВысотаСтроки, МаксимальноеКоличествоВидовВремени);
	
	ОбозначенияВидовВремени = УчетРабочегоВремениРасширенныйКлиентСервер.ТабельОбозначенияВидовВремени(Форма.ОписаниеВидовВремени);

КонецПроцедуры	

Процедура ТабельЗаполнитьИтогиПоСотрудникамДокумента(Форма) Экспорт
	ОбозначенияВидовВремени = УчетРабочегоВремениРасширенныйКлиентСервер.ТабельОбозначенияВидовВремени(Форма.ОписаниеВидовВремени);
	
	СтрокиПоСотруднику = Новый Массив;	
	ТекущийСотрудник = Неопределено;
	ВидОтображенияВремени = Форма.ЭтотОбъект.ПереключательВидаОтображенияВремени;
	Для Каждого СтрокаДанныхОВремени Из Форма.Объект.ДанныеОВремени Цикл
		Если СтрокаДанныхОВремени.Сотрудник <> ТекущийСотрудник 
			И СтрокиПоСотруднику.Количество() > 0 Тогда
			УчетРабочегоВремениРасширенныйКлиентСервер.ТабельЗаполнитьИтогиПоСотруднику(СтрокиПоСотруднику, ОбозначенияВидовВремени, ВидОтображенияВремени);	
			
			СтрокиПоСотруднику = Новый Массив;
			СтрокиПоСотруднику.Добавить(СтрокаДанныхОВремени);
			
			ТекущийСотрудник = СтрокаДанныхОВремени.Сотрудник;
		Иначе	
			СтрокиПоСотруднику.Добавить(СтрокаДанныхОВремени);
			ТекущийСотрудник = СтрокаДанныхОВремени.Сотрудник;
		КонецЕсли;		
	КонецЦикла;	
	
	Если СтрокиПоСотруднику.Количество() > 0 Тогда
		УчетРабочегоВремениРасширенныйКлиентСервер.ТабельЗаполнитьИтогиПоСотруднику(СтрокиПоСотруднику, ОбозначенияВидовВремени, ВидОтображенияВремени);	
	КонецЕсли;	
КонецПроцедуры	

Функция ТабельНоваяСтрокаДанныхОВремени(ДанныеОВремени, Сотрудник, НомерСтрокиСотрудник, ВысотаСтроки)
	СтрокиПоСотруднику = Новый Массив;
	
	НоваяСтрока = ДанныеОВремени.Добавить();
	НоваяСтрока.Сотрудник = Сотрудник;
	НоваяСтрока.НомерСтрокиСотрудник = НомерСтрокиСотрудник;
	НоваяСтрока.ЭтоПерваяСтрокаПоСотруднику = Истина;
	НоваяСтрока.ЧетнаяСтрока = (НомерСтрокиСотрудник % 2 = 0); 
	НоваяСтрока.ПустаяСтрока = Истина;
	
	СтрокиПоСотруднику.Добавить(НоваяСтрока);
	
	Для Сч = 2 По ВысотаСтроки Цикл
		НоваяСтрока = ДанныеОВремени.Добавить();
		НоваяСтрока.Сотрудник = Сотрудник;
		НоваяСтрока.НомерСтрокиСотрудник = НомерСтрокиСотрудник;
		НоваяСтрока.ЭтоПерваяСтрокаПоСотруднику = Ложь;
		НоваяСтрока.ЧетнаяСтрока = (НомерСтрокиСотрудник % 2 = 0); 
		НоваяСтрока.ПустаяСтрока = Истина;
		
		СтрокиПоСотруднику.Добавить(НоваяСтрока);
	КонецЦикла;	
	
	Возврат СтрокиПоСотруднику;
КонецФункции

Процедура ТабельОчиститьСтрокиСотрудника(СтрокиПоСотруднику)
	Для Каждого СтрокаДанныхОВремени Из СтрокиПоСотруднику Цикл
		СтрокаДанныхОВремени.ВремяИтог = "";
		Для НомерДня = 1 По 31 Цикл
			СтрокаДанныхОВремени["Часов" + НомерДня] = 0;      
			СтрокаДанныхОВремени["ВидВремени" + НомерДня] = Справочники.уатВидыИспользованияРабочегоВремени.ПустаяСсылка();
			СтрокаДанныхОВремени["Время" + НомерДня + "Представление"] = "";
			СтрокаДанныхОВремени["ЧасовНорма" + НомерДня] = 0;
		КонецЦикла;	
	КонецЦикла;		
КонецПроцедуры	

Процедура ДанныеОВремениСортироватьПоВозрастанию(ДанныеОВремени, АльтернативнаяФорма = Ложь) Экспорт
	ДанныеОВремениСортировать(ДанныеОВремени, "Возр", АльтернативнаяФорма);	
КонецПроцедуры

Процедура ДанныеОВремениСортироватьПоУбыванию(ДанныеОВремени, АльтернативнаяФорма = Ложь) Экспорт
	ДанныеОВремениСортировать(ДанныеОВремени, "Убыв", АльтернативнаяФорма);
КонецПроцедуры

Процедура ДанныеОВремениСортировать(ДанныеОВремени, Направление, АльтернативнаяФорма)
	
	ТаблицаДляСортировки = ДанныеОВремени.Выгрузить();
	ТаблицаДляСортировки.Колонки.Добавить("КлючСортировки");
	ТаблицаДляСортировки.Колонки.Добавить("СотрудникПредставление");
	КолонкаСотрудник = ТаблицаДляСортировки.ВыгрузитьКолонку("Сотрудник");
	КолонкаНомерСтроки = ТаблицаДляСортировки.ВыгрузитьКолонку("НомерСтроки");
	
	СотрудникиПредставление = ОбщегоНазначения.ЗначениеРеквизитаОбъектов(КолонкаСотрудник, "Наименование");
	Для каждого СтрокаТаблицы Из ТаблицаДляСортировки Цикл
		СтрокаТаблицы.СотрудникПредставление = СотрудникиПредставление.Получить(СтрокаТаблицы.Сотрудник);
	КонецЦикла; 
	
	ТаблицаДляСортировки.ЗагрузитьКолонку(КолонкаНомерСтроки, "КлючСортировки");
	ТаблицаДляСортировки.Сортировать("СотрудникПредставление " + Направление + ", КлючСортировки");
	ДанныеОВремени.Загрузить(ТаблицаДляСортировки);
	
	Если Не АльтернативнаяФорма Тогда
		
		НомерСтрокиСотрудник = 0;
		Для Каждого ОбрабатываемаяСтрока Из ДанныеОВремени Цикл
			
			Если ОбрабатываемаяСтрока.ЭтоПерваяСтрокаПоСотруднику Тогда
				НомерСтрокиСотрудник = НомерСтрокиСотрудник + 1;	
			КонецЕсли;
				
			ОбрабатываемаяСтрока.ЧетнаяСтрока = (НомерСтрокиСотрудник % 2 = 0);
			ОбрабатываемаяСтрока.НомерСтрокиСотрудник = НомерСтрокиСотрудник;
			
		КонецЦикла;
		
	КонецЕсли;
	
КонецПроцедуры

// Процедура удаляет строки с видом времени Выходные и нулевым количеством часов,
// если на эту же дату есть строки с ненулевым количеством часов
//
Процедура УдалитьПустыеВыходныеЕслиЕстьРабочееВремя(ДанныеОВремени)
	мсвСтрокУдалить = Новый Массив;
	Для Каждого ТекСтрока Из ДанныеОВремени Цикл
		Если ТекСтрока.ВидУчетаВремени = Справочники.уатВидыИспользованияРабочегоВремени.ВыходныеДни
			И ТекСтрока.Часы = 0 Тогда
			мсвСтрокПоиска = ДанныеОВремени.НайтиСтроки(Новый Структура("Дата", ТекСтрока.Дата));
			Для Каждого ТекСтрокаПоиска Из мсвСтрокПоиска Цикл
				Если ТекСтрокаПоиска.Часы > 0 Тогда
					мсвСтрокУдалить.Добавить(ТекСтрока);
					Прервать;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
	КонецЦикла;
	Для Каждого ТекСтрокаУдалить Из мсвСтрокУдалить Цикл
		ДанныеОВремени.Удалить(ТекСтрокаУдалить);
	КонецЦикла;
КонецПроцедуры

#КонецОбласти
