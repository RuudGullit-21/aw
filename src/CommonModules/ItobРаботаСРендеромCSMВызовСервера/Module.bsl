////////////////////////////////////////////////////////////////////////////////
// Работа с рендером CSM (Вызов сервера)
// 
////////////////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

// Очищает данные профиля по номеру.
//
// Параметры:
//  НомерПрофиля - Число - Номер профиля.
//
Процедура ОчиститьДанныеПрофиля(НомерПрофиля) Экспорт
	
	ИмяФайлаОтвета = ПолучитьИмяВременногоФайла("txt");
		
	АдресСервера = ItobОперативныйМониторинг.ПолучитьАдресСервисаCsmSvcСервер();
	Сервер = Лев(АдресСервера,  Найти(АдресСервера,":") - 1);
	Порт   = Число(Сред(АдресСервера, Найти(АдресСервера,":") + 1));
	
	Результат = "";	
	
	Запрос = Новый HTTPЗапрос("/DelProfile?itob_prof="+НомерПрофиля);
	
	HTTP = Новый HTTPСоединение(Сервер,Порт);
	Попытка
		HTTP.Получить(Запрос, ИмяФайлаОтвета);		
		ТекстДок2 = Новый ТекстовыйДокумент;
		ТекстДок2.Прочитать(ИмяФайлаОтвета);		
		Результат = ТекстДок2.ПолучитьСтроку(1);
	Исключение
		ItobРаботаС_БСП_КлиентСервер.СообщитьПользователю(НСтр("ru = 'Ошибка удаления профиля:"+" "+НомерПрофиля+"'")+" " + ОписаниеОшибки());
	КонецПопытки;
	
КонецПроцедуры

#КонецОбласти
